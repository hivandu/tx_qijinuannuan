!function(t){"use strict";function e(t,e){return e.indexOf(t)>-1}function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function n(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function s(t,e){n(t,e)||(t.className+=" "+e)}function a(t,e){n(t,e)&&(t.className=t.className.replace(RegExp("(\\s|^)"+e+"(\\s|$)"),""))}function h(t){if(/<\/?[^>]*>/g.test(t))return!1;var e="^(((https|http|ftp|rtsp|mms):)?//)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+.)*([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].[a-z]{2,6})?(:[0-9]{1,4})?([^?#]+)?(\\?[^#]+)?(#.+)?$";return new RegExp(e).test(t)}var r=function(){var t=Array.prototype.slice.call(arguments,0,3);if(!t.length)throw new Error("Parameters required!");var e="[object Object]"===Object.prototype.toString.call(t.slice(-1)[0])?t.pop():{};switch(t.length){case 2:e.data=e.data||t[1];case 1:e.dom=e.dom||t[0]}if(!e.dom)throw new Error("Container can not be empty!");if(!e.data||!e.data.length)throw new Error("Data must be an array and must have more than one element!");this._opts=e,this._LSN={},this._EventHandle={},e=t=null,this._setting(),this.fire("initialize"),this._renderWrapper(),this._initPlugins(),this._bindHandler()};r.EVENTS="initialize slide slideStart slideEnd slideChange slideChanged slideRestore slideRestored reloadData destroy".split(" "),r.EASING=["linear ease ease-in ease-out ease-in-out".split(" "),/cubic-bezier\(([^\d]*(\d+.?\d*)[^\,]*\,?){4}\)/],r.FIX_PAGE_TAGS="SELECT INPUT TEXTAREA BUTTON LABEL".split(" "),r.EMPTY_FUNCTION=function(){},r.extend=function(){var t,e,i=arguments;switch(i.length){case 0:return;case 1:t=r.prototype,e=i[0];break;case 2:t=i[0],e=i[1]}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r.plugins={},r.regPlugin=function(t,e){r.plugins[t]=r.plugins[t]||e},r._animateFuncs={"default":function(t,e,i,n,s){t.style.webkitTransform="translateZ(0) translate"+e+"("+(s+i*(n-1))+"px)"}},r._transitionEndEvent=function(){var t;return function(){if(t)return t;var e=document.createElement("fakeElement"),i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var n in i)if(i.hasOwnProperty(n)&&void 0!==e.style[n])return t=i[n]}}();var o=r.prototype;o.extend=r.extend,o._setting=function(){this._plugins=r.plugins,this._animateFuncs=r._animateFuncs,this.holding=!1,this.locking=!1;var n=this._opts;this.wrap=n.dom,this.data=n.data,this.isVertical=n.isVertical||!1,this.isOverspread=n.isOverspread||!1,this.duration=n.duration||2e3,this.initIndex=n.initIndex>0&&n.initIndex<n.data.length-1?n.initIndex:0,this.fixPage=void 0===n.fixPage?!0:n.fixPage,this.slideIndex=this.slideIndex||this.initIndex||0,this.axis=this.isVertical?"Y":"X",this.reverseAxis="Y"===this.axis?"X":"Y",this.width=this.wrap.clientWidth,this.height=this.wrap.clientHeight,this.ratio=this.height/this.width,this.scale=this.isVertical?this.height:this.width,this.offset=this.offset||{X:0,Y:0},this.isLooping=this.data.length>1&&n.isLooping?!0:!1,this.isAutoplay=this.data.length>1&&n.isAutoplay?!0:!1,"card"===n.animateType&&this.isVertical&&(this.isOverspread=!0),this.log=n.isDebug?function(){t.console.log.apply(t.console,arguments)}:r.EMPTY_FUNCTION,this._setUpDamping(),this._animateFunc=this._animateFuncs[n.animateType in this._animateFuncs?n.animateType:"default"],this.animateTime=null!=n.animateTime&&n.animateTime>-1?n.animateTime:300,this.animateEasing=e(n.animateEasing,r.EASING[0])||r.EASING[1].test(n.animateEasing)?n.animateEasing:"ease",this.inAnimate=0,this.deviceEvents=function(){var e=!!("ontouchstart"in t||t.DocumentTouch&&document instanceof t.DocumentTouch);return{hasTouch:e,startEvt:e?"touchstart":"mousedown",moveEvt:e?"touchmove":"mousemove",endEvt:e?"touchend":"mouseup"}}(),this.events={},this.on("slide",n.onslide),this.on("slideStart",n.onslidestart),this.on("slideEnd",n.onslideend),this.on("slideChange",n.onslidechange),this.on("slideChanged",n.onslidechanged),this.on("slideRestore",n.onsliderestore),this.on("slideRestored",n.onsliderestored),this.pluginConfig=function(){if(i(n.plugins)){var t={};return n.plugins.forEach(function(e){i(e)?t[e[0]]=e.slice(1):"string"==typeof e&&(t[e]=[])}),t}return{}}(),this.isAutoplay&&this.play()},o._initPlugins=function(){var t=this.pluginConfig,e=this._plugins;for(var i in t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)&&(this.log("[INIT PLUGIN]:",i,e[i]),e[i]&&"function"==typeof e[i]&&typeof e[i].apply&&e[i].apply(this,t[i]))},o._setUpDamping=function(){var t=this.scale>>1,e=t>>1,i=e>>2;this._damping=function(n){var s,a=Math.abs(n);return s=t>a?a>>1:t+e>a?e+(a-t>>2):e+i+(a-t-e>>3),n>0?s:-s}},o._itemType=function(t){if(isNaN(t)||(t=this.data[t]),t.hasOwnProperty("type"))return t.type;var e,i=t.content;return e=null==i?"empty":Boolean(i.nodeName)&&Boolean(i.nodeType)?"node":"string"==typeof i?h(i)?"pic":"html":"unknown",t.type=e,e},o._renderItem=function(t,e){var i,n=this.data.length,s=function(){var e=' src="'+i.content+'"';e+=i.height/i.width>this.ratio?' height="100%"':' width="100%"',this.isOverspread&&(t.style.background="url("+i.content+") no-repeat 50% 50%/cover",e+=' style="display:block;opacity:0;height:100%;width:100%;"'),t.innerHTML="<img"+e+" />"}.bind(this);if(t.innerHTML="",t.style.background="",this.isLooping||null!=this.data[e]){e=(n+e)%n,i=this.data[e];var a=this._itemType(i);switch(this.log("[Render ITEM]:",a,e,i),t.className="islider-"+a,a){case"pic":if(i.height&&i.width)s();else{var h=new Image;h.src=i.content,h.onload=function(){i.height=h.height,i.width=h.width,i.loaded=1,s()}}break;case"dom":case"html":t.innerHTML=i.content;break;case"node":case"element":if(11===i.content.nodeType){var r=document.createElement("div");r.appendChild(i.content),i.content=r}t.appendChild(i.content)}}},o._renderIntermediateScene=function(){null!=this._intermediateScene&&(this._renderItem.apply(this,this._intermediateScene),this._intermediateScene=null)},o._changedStyles=function(){var t=["islider-prev","islider-active","islider-next"];this.els.forEach(function(e,i){a(e,"("+t.join("|")+")"),s(e,t[i])})},o._renderWrapper=function(){this.outer&&(this.outer.innerHTML="");var e=this.outer||document.createElement("ul");e.className="islider-outer",this.els=[];for(var i=0;3>i;i++){var n=document.createElement("li");this.els.push(n),this._animateFunc(n,this.axis,this.scale,i,0),!this.isVertical||"rotate"!==this._opts.animateType&&"flip"!==this._opts.animateType?this._renderItem(n,i-1+this.slideIndex):this._renderItem(n,1-i+this.slideIndex),e.appendChild(n)}this._changedStyles(),t.setTimeout(function(){this._preloadImg(this.slideIndex)}.bind(this),200),this.outer||(this.outer=e,this.wrap.appendChild(e))},o._preloadImg=function(t){if(this.data.length>3){var e=this.data,i=e.length,n=this,s=function(t){var i=e[t];if("pic"===n._itemType(i)&&!i.loaded){var s=new Image;s.src=i.content,s.onload=function(){i.width=s.width,i.height=s.height},i.loaded=1}};s((t+2)%i),s((t-2+i)%i)}},o._watchTransitionEnd=function(e,i){function n(){a&&t.clearTimeout(a),h.inAnimate--,h.log("Event:","watchTransitionEnd::stuck::release",h.inAnimate),0===h.inAnimate&&("slideChanged"===i&&h._changedStyles(),h.fire.apply(h,o),h._renderIntermediateScene()),s()}function s(){h.els.forEach(function(t){t.removeEventListener(r._transitionEndEvent(),n)}),h.isAnimating=!1}var a,h=this,o=Array.prototype.slice.call(arguments,1);this.log("Event:","watchTransitionEnd::stuck::pile",this.inAnimate),e>0&&h.els.forEach(function(t){t.addEventListener(r._transitionEndEvent(),n)}),a=t.setTimeout(n,e),h.inAnimate++},o._bindHandler=function(){var e=this.outer,i=this.deviceEvents;i.hasTouch||(e.style.cursor="pointer",e.ondragstart=function(t){return t?!1:!0}),e.addEventListener(i.startEvt,this),e.addEventListener(i.moveEvt,this),e.addEventListener(i.endEvt,this),t.addEventListener("orientationchange",this),t.addEventListener("resize",this),t.addEventListener("focus",this,!1),t.addEventListener("blur",this,!1)},o.handleEvent=function(t){var e=this.deviceEvents;switch(t.type){case"mousedown":if(0!==t.button)break;case"touchstart":this.startHandler(t);break;case e.moveEvt:this.moveHandler(t);break;case e.endEvt:case"touchcancel":this.endHandler(t);break;case"orientationchange":this.orientationchangeHandler();break;case"focus":this.isAutoplay&&this.play();break;case"blur":this.pause();break;case"resize":this.resizeHandler()}},o.startHandler=function(t){if(this.fixPage&&r.FIX_PAGE_TAGS.indexOf(t.target.tagName)<0&&t.preventDefault(),!this.holding&&!this.locking){var e=this.deviceEvents;this.isMoving=!0,this.pause(),this.log("Event: start"),this.fire("slideStart",t,this),this.startTime=(new Date).getTime(),this.startX=e.hasTouch?t.targetTouches[0].pageX:t.pageX,this.startY=e.hasTouch?t.targetTouches[0].pageY:t.pageY}},o.moveHandler=function(t){if(this.isMoving){this.log("Event: moving");var e=this.deviceEvents,i=this.data.length,n=this.axis,s=this.reverseAxis,a={X:e.hasTouch?t.targetTouches[0].pageX-this.startX:t.pageX-this.startX,Y:e.hasTouch?t.targetTouches[0].pageY-this.startY:t.pageY-this.startY};if(this.offset=a,Math.abs(a[n])-Math.abs(a[s])>10){t.preventDefault(),this.fire("slide",t,this),this.isLooping||(a[n]>0&&0===this.slideIndex||a[n]<0&&this.slideIndex===i-1)&&(a[n]=this._damping(a[n]));for(var h=0;3>h;h++){var r=this.els[h];r.style.webkitTransition="all 0s",this._animateFunc(r,n,this.scale,h,a[n])}}}},o.endHandler=function(e){if(this.isMoving){this.log("Event: end"),this.isMoving=!1;var i=this.offset,n=this.axis,s=this.scale/2,a=(new Date).getTime();s=a-this.startTime>300?s:14;var h=Math.abs(i[n]),r=Math.abs(i[this.reverseAxis]),o=function(e){if("A"===e.tagName){if(e.href)return t.location.href=e.href,!1}else{if("islider-pic"!==e.className)return!1;o(e.parentNode)}};this.log(s,i[n],h,r,this),this.slideTo(i[n]>=s&&h>r?this.slideIndex-1:i[n]<-s&&h>r?this.slideIndex+1:this.slideIndex),Math.abs(this.offset.X)<10&&Math.abs(this.offset.Y)<10&&(this.tapEvt=document.createEvent("Event"),this.tapEvt.initEvent("tap",!0,!0),this.fixPage&&e.target&&o(e.target),e.target.dispatchEvent(this.tapEvt)||e.preventDefault()),this.offset.X=this.offset.Y=0,this.isAutoplay&&this.play(),this.fire("slideEnd",e,this)}},o.orientationchangeHandler=function(){t.setTimeout(function(){this.reset(),this.log("Event: orientationchange")}.bind(this),100)},o.resizeHandler=function(){(this.height!==this.wrap.clientHeight||this.width!==this.wrap.clientWidth)&&(this._LSN.resize&&t.clearTimeout(this._LSN.resize),this._LSN.resize=t.setTimeout(function(){this.reset(),this.log("Event: resize"),this._LSN.resize&&t.clearTimeout(this._LSN.resize)}.bind(this),500))},o.slideTo=function(e,i){if(!this.locking){this.unhold();var n,s=this.animateTime,a=this._opts.animateType,h=this._animateFunc,r=this.data,o=this.els,l=e,d=e-this.slideIndex,c=this.offset;"object"==typeof i&&(i.animateTime>-1&&(s=i.animateTime),"string"==typeof i.animateType&&i.animateType in this._animateFuncs&&(a=i.animateType,h=this._animateFuncs[a]));var u=Math.abs(c[this.axis])/this.scale*s;Math.abs(d)>1&&this._renderItem(d>0?this.els[2]:this.els[0],l),this._preloadImg(l),r[l]?this.slideIndex=l:this.isLooping?this.slideIndex=d>0?0:r.length-1:(this.slideIndex=this.slideIndex,d=0),this.log("Index:"+this.slideIndex);var p,f,v;0===d?n="slideRestore":((this.isVertical&&("rotate"===a||"flip"===a))^d>0?(o.push(o.shift()),p=o[2],f=o[0],v=1):(o.unshift(o.pop()),p=o[0],f=o[2],v=-1),1===Math.abs(d)?(this._renderIntermediateScene(),this._renderItem(p,l+d)):Math.abs(d)>1&&(this._renderItem(p,l+v),this._intermediateScene=[f,l-v]),p.style.webkitTransition="none",p.style.visibility="hidden",t.setTimeout(function(){p.style.visibility="visible"},200),u=s-u,n="slideChange"),this.fire(n,this.slideIndex,o[1],this),this._watchTransitionEnd(u,n+"d",this.slideIndex,o[1],this);for(var g=0;3>g;g++)o[g]!==p&&(o[g].style.webkitTransition="all "+u/1e3+"s "+this.animateEasing),h.call(this,o[g],this.axis,this.scale,g,0);this.isAutoplay&&!this.isLooping&&this.slideIndex===r.length-1&&this.pause()}},o.slideNext=function(){this.slideTo.apply(this,[this.slideIndex+1].concat(Array.prototype.slice.call(arguments)))},o.slidePrev=function(){this.slideTo.apply(this,[this.slideIndex-1].concat(Array.prototype.slice.call(arguments)))},o.regPlugin=function(){var t=Array.prototype.slice.call(arguments),i=t.shift(),n=t[0];(this._plugins.hasOwnProperty(i)||"function"==typeof n)&&("function"==typeof n&&(this._plugins[i]=n,t.shift()),e(i,this._opts.plugins)||(this._opts.plugins.push(t.length?[].concat([i],t):i),"function"==typeof this._plugins[i]&&this._plugins[i].apply(this,t)))},o.bind=o.delegate=function(e,i,n){function s(e){for(var s=t.event?t.event:e,a=s.target,h=document.querySelectorAll(i),r=0;r<h.length;r++)if(a===h[r]){n.call(a);break}}this.wrap.addEventListener(e,s,!1);var a=e+";"+i;this._EventHandle.hasOwnProperty(a)?(this._EventHandle[a][0].push(n),this._EventHandle[a][1].push(s)):this._EventHandle[a]=[[n],[s]]},o.unbind=o.unDelegate=function(t,e,i){var n=t+";"+e;if(this._EventHandle.hasOwnProperty(n)){var s=this._EventHandle[n][0].indexOf(i);if(s>-1)return this.wrap.removeEventListener(t,this._EventHandle[n][1][s]),this._EventHandle[n][0][s]=this._EventHandle[n][1][s]=null,!0}return!1},o.destroy=function(){var e=this.outer,i=this.deviceEvents;this.fire("destroy"),e.removeEventListener(i.startEvt,this),e.removeEventListener(i.moveEvt,this),e.removeEventListener(i.endEvt,this),t.removeEventListener("orientationchange",this),t.removeEventListener("focus",this),t.removeEventListener("blur",this);for(var n in this._EventHandle)for(var s=this._EventHandle[n][1],a=0;a<s.length;a++)"function"==typeof s[a]&&this.wrap.removeEventListener(n.substr(0,n.indexOf(";")),s[a]);this._EventHandle=null;for(var n in this._LSN)this._LSN.hasOwnProperty(n)&&this._LSN[n]&&t.clearTimeout(this._LSN[n]);this._LSN=null,this.wrap.innerHTML=""},o.on=function(t,i){e(t,r.EVENTS)&&"function"==typeof i&&(t in this.events?this.events[t]:this.events[t]=[]).push(i)},o.off=function(t,e){if(t in this.events){var i=this.events[t],n=i.indexOf(e);n>-1&&delete i[n]}},o.fire=function(t){if(this.log("[EVENT FIRE]:",t,arguments),t in this.events)for(var e=this.events[t],i=0;i<e.length;i++)"function"==typeof e[i]&&e[i].apply&&e[i].apply(this,Array.prototype.slice.call(arguments,1))},o.reset=function(){this.pause(),this._setting(),this._renderWrapper(),this.isAutoplay&&this.play()},o.loadData=function(t,e){this.pause(),this.slideIndex=e||0,this.data=t,this._renderWrapper(),this.fire("reloadData"),this.isAutoplay&&this.play()},o.play=function(){function e(){i._LSN.autoPlay=setTimeout(function(){i.slideNext(),e()},i.duration)}var i=this;this._LSN.autoPlay&&t.clearTimeout(this._LSN.autoPlay),e()},o.pause=function(){this._LSN.autoPlay&&clearTimeout(this._LSN.autoPlay)},o.hold=function(){this.holding=!0},o.unhold=function(){this.holding=!1,this.unlock()},o.lock=function(){this.hold(),this.locking=!0},o.unlock=function(){this.locking=!1},"function"==typeof require&&"object"==typeof module&&module&&"object"==typeof exports&&exports?module.exports=r:"function"==typeof define&&define.amd?define(function(){return r}):t.iSlider=t.iSlider||r}(this||window);